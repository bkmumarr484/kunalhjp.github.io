<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Visual Stress Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
  html,body{margin:0;height:100%;background:#000;overflow:hidden;font-family:system-ui}
  #ui{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
    background:radial-gradient(circle at 30% 30%, #0b1a2a, #000);
    z-index:2
  }
  .card{
    background:rgba(255,255,255,.06);backdrop-filter:blur(14px);
    border:1px solid rgba(255,255,255,.18);border-radius:18px;
    padding:28px 24px;max-width:360px;text-align:center;color:#cfe9ff;
    box-shadow:0 30px 80px rgba(0,0,0,.7)
  }
  .card h1{margin:0 0 8px;font-size:22px}
  .card p{margin:0 0 18px;font-size:14px;opacity:.9}
  .btns{display:flex;gap:10px;justify-content:center}
  button{
    padding:12px 16px;border-radius:12px;border:1px solid #4fc3ff;
    background:#0b5cff;color:#fff;font-weight:700;cursor:pointer
  }
  button.alt{background:transparent}
  #hud{
    position:fixed;bottom:14px;left:50%;transform:translateX(-50%);
    color:#9fd7ff;font-size:12px;opacity:.9;z-index:1
  }
  canvas{display:block}
</style>
</head>
<body>

<div id="ui">
  <div class="card">
    <h1>Visual Stress Demo</h1>
    <p>Opt-in cinematic GPU demo. Start when ready. Stop anytime.</p>
    <div class="btns">
      <button id="start">START</button>
      <button id="stop" class="alt">STOP</button>
    </div>
  </div>
</div>

<div id="hud"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
let renderer, scene, camera, points, running=false, quality=1;
const hud=document.getElementById('hud');

function detectQuality(){
  const mem = navigator.deviceMemory || 4;
  const cores = navigator.hardwareConcurrency || 4;
  // very simple heuristic
  quality = (mem>=6 && cores>=6) ? 1.4 : (mem>=4 ? 1 : .7);
}

function init(){
  detectQuality();
  scene=new THREE.Scene();
  camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,.1,1000);
  camera.position.z=6;

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  renderer.setPixelRatio(Math.min(devicePixelRatio,2));
  document.body.appendChild(renderer.domElement);

  // particles
  const COUNT=Math.floor(120000*quality); // looks heavy, still safe
  const geo=new THREE.BufferGeometry();
  const pos=new Float32Array(COUNT*3);
  for(let i=0;i<COUNT;i++){
    pos[i*3+0]=(Math.random()-.5)*40;
    pos[i*3+1]=(Math.random()-.5)*40;
    pos[i*3+2]=(Math.random()-.5)*40;
  }
  geo.setAttribute('position',new THREE.BufferAttribute(pos,3));
  const mat=new THREE.PointsMaterial({color:0x6ecbff,size:.03,transparent:true,opacity:.9});
  points=new THREE.Points(geo,mat);
  scene.add(points);

  window.addEventListener('resize',onResize);
  animate();
}

function animate(){
  if(!running) return;
  requestAnimationFrame(animate);
  points.rotation.y+=.0015;
  points.rotation.x+=.0009;
  camera.position.z=6+Math.sin(performance.now()*0.0004)*.2;
  renderer.render(scene,camera);
  hud.textContent=`Particles: ${points.geometry.attributes.position.count} | Quality: ${quality}`;
}

function onResize(){
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
}

document.getElementById('start').onclick=()=>{
  if(running) return;
  document.getElementById('ui').style.display='none';
  if(!renderer) init();
  running=true; animate();
};

document.getElementById('stop').onclick=()=>{
  running=false;
  document.getElementById('ui').style.display='flex';
};
</script>
</body>
</html>